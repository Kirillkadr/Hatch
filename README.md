# Smart Patches project

## Актуальность (Motivation)
HatchMatch создан для упрощения процесса применения Git-патчей. Традиционные патчи сложны для анализа и применения, особенно в крупных проектах. Логический язык Hatch позволяет описывать изменения декларативно, повышая читаемость и автоматизируя процесс.


## Суть (In a nutshell)
Прототип инструмента применения гит-патчей - *рекурсивный интерпретатор* логического языка ***Hatch*** (в переводе "люк") с тремя операторами: `...`, `>>>`, `<<<`. 

## В двух словах

HatchMatch:
- Парсит Markdown-файлы с комментариями, инструкциями Hatch и содержимым патча.
- Токенизирует код и ищет позиции для вставки изменений.
- Поддерживает языки, такие как Python и C++, с учетом вложенности и специальных операторов.

## Установка

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/Kirillkadr/HatchMatch.git
   ```
2. Перейдите в директорию проекта:
   ```bash
   cd HatchMatch
   ```
3. Установите зависимости:
   ```bash
   pip install pywebview pygments
   ```
4. Запустите интерфейс:
   ```bash
   python source/main.py
   ```

## Использование

1. Подготовьте Markdown-файл (например, `test/example.md`):
   
```markdown
   ### match:
   ... 
   class MyClass {
   >>> 
   ... 
   };

   ### patch
   
   void myFunction() {}
   
   ```
2. Подготовьте исходный файл (например, `source/example.cpp`) через интерфейс или укажите вручную.
3. Выберите язык (например, `cpp`).
4. Нажмите "Применить" для обработки.

## Архитектура и структура репозитория

Прототип написан на Python и использует `pywebview` для UI и `pygments` для токенизации. Структура проекта:

| Файл/Директория                | Описание                                                                 |
|--------------------------------|--------------------------------------------------------------------------|
| `unique3.cpp`, `unique5.cpp`, ... | Исходные файлы на C++ для тестирования                                   |
| `unique3.md`, `unique5.md`, ... | Markdown-файлы с инструкциями и пачами для тестирования                                   |
| `test/`                        | Директория с тестовыми Markdown-файлами                                  |
| `source/`                        | Директория с тестовыми с исходными файлами на C++                                   |
| `LoadFromUI.py`         | Загрузка и парсинг данных из UI или файлов                               |
| `logfile.log`           | Лог-файл для отладки                                                     |
| `Main.py`               | Точка входа для UI, запуск приложения                                    |
| `MainCMD.py`           | Точка входа для командной строки                                         |
| `MainTest.py`          | Модуль для автоматизированного тестирования                              |
| `SearchCode.py`         | Логика поиска позиций вставки в коде                                     |
| `TokenizeCode.py`       | Токенизация кода с учетом операторов Hatch                               |
| `UsersUX.html`          | HTML-файл для графического интерфейса                                    |
| `UsersUXScripts.js`     | JavaScript-логика для взаимодействия с UI                                |
| `UsersUXStyle.css`      | Стили для интерфейса                                                     |


## Зависимости

- **pywebview**: Для графического интерфейса.
- **pygments**: Для токенизации кода.
Установите через:
```bash
pip install pywebview pygments
```

## Ресурсы

- [Интерпретаторы байт-кодов своими руками | Habr](https://habr.com/ru/companies/badoo/articles/425325/)
- [Как я выбирал Markdown-парсер | Habr](https://habr.com/ru/articles/672266/)
- [Алгоритмы. Рекурсивные функции | Habr](https://habr.com/ru/articles/857086/)
- [Arend – язык с зависимыми типами, основанный на HoTT | Habr](https://habr.com/ru/companies/JetBrains-education/articles/469569/)

## Заключение

HatchMatch — экспериментальный инструмент для управления Git-патчами через логический язык Hatch, упрощающий и структурирующий процесс изменений кода.